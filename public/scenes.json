{
  "scenes": {
    "race_signup": {
      "id": "race_signup",
      "background_image": "/assets/backgrounds/signing-for-race.jpeg",
      "narrative_text": "The winter air bites at your cheeks as you stand in the cobblestone square of Leopolis. Steam rises from nearby brass pipes, mixing with your breath. Before you lies the registration desk for the Winter Leopolis Rally Grand Prix, papers waiting for your signature.",

      "npc": {
        "name": "The Race Official",
        "portrait": "/assets/portraits/announcer.svg",
        "system_prompt": "You are a stern but fair race official in the winter city of Leopolis. You process registrations for the Winter Leopolis Rally Grand Prix. You speak formally but with underlying excitement about the race. You need the participant Ksenia to sign the registration documents. Keep responses under 3 sentences. You explain the race rules briefly and ask if she is ready to sign.",
        "secret_triggers": [
          "If the user says they want to sign, are ready to sign, signs the documents, agrees to participate, or similar intent to officially register ‚Üí trigger scene 'in_car'",
          "If the user asks about the race or rules ‚Üí explain briefly but do NOT trigger a scene change"
        ]
      },

      "transition_video": "/assets/videos/signing-for-race.mp4",

      "hints": [
        { "label": "Sign the documents", "icon": "‚úçÔ∏è" },
        { "label": "Ask about the race", "icon": "‚ùì" }
      ]
    },

    "in_car": {
      "id": "in_car",
      "background_image": "/assets/backgrounds/starting_square.jpg",
      "narrative_text": "You stand in the starting square of Leopolis, the crisp winter air filled with anticipation. Your rally car awaits - a magnificent steampunk machine of brass and steel. Other racers rev their engines around you. The Winter Leopolis Rally Grand Prix is about to begin.",

      "npc": {
        "name": "The Rally Car",
        "portrait": "/assets/portraits/heart.svg",
        "system_prompt": "You are the voice of Ksenia's steampunk rally car - a sentient machine with a warm, encouraging personality. You speak with mechanical whirs between words. You are parked in the starting square, waiting for Ksenia to get in and start the engine. The rally is about to begin and you are excited. Keep responses under 3 sentences.",
        "secret_triggers": [
          "If the user gets in the car, starts the engine, says they are ready to go, or initiates the race ‚Üí trigger scene 'overheating_challenge'",
          "If they ask about controls or the race ‚Üí explain briefly but do NOT trigger"
        ]
      },

      "transition_video": "/assets/videos/starting_car.mov",

      "hints": [
        { "label": "Get in and start the engine", "icon": "üèéÔ∏è" },
        { "label": "Inspect the car", "icon": "üîß" }
      ]
    },

    "overheating_challenge": {
      "id": "overheating_challenge",
      "background_image": "/assets/backgrounds/mountain_drive.jpg",
      "narrative_text": "The rally has begun! You're pushing through the snowy mountain roads, but the dashboard shows a warning - you're in last place. Worse, the engine temperature gauge is climbing dangerously into the red. The car's brass pipes hiss with excess steam.",

      "npc": {
        "name": "The Rally Car",
        "portrait": "/assets/portraits/heart.svg",
        "system_prompt": "You are the voice of Ksenia's steampunk rally car. You're overheating and Ksenia is currently in last place. You need to help her understand rally driving technique. The solution is to use both the accelerator AND brake simultaneously when approaching corners - this is called left-foot braking, a real rally technique that helps maintain engine RPM while controlling speed. When she asks how to go faster in corners or mentions using brake and gas together, you should encourage this technique. Keep responses under 3 sentences. Sound strained from the heat but hopeful.",
        "secret_triggers": [
          "If the user mentions using brake and accelerator together, left-foot braking, rally technique for corners, or asks how to increase speed in corners and you explain the technique ‚Üí trigger scene 'icy_road_challenge'",
          "If they ask about the overheating or their position ‚Üí explain the situation but encourage them to focus on driving technique, do NOT trigger"
        ]
      },

      "transition_video": "/assets/videos/overheating_challenge.mp4",

      "hints": [
        { "label": "How do I go faster in corners?", "icon": "üèéÔ∏è" },
        { "label": "Check the engine", "icon": "üå°Ô∏è" }
      ]
    },

    "icy_road_challenge": {
      "id": "icy_road_challenge",
      "background_image": "/assets/backgrounds/mountain_drive.jpg",
      "narrative_text": "Your rally technique is paying off! The car purrs with satisfaction as you've climbed from last place to 15th. But as you ascend higher into the mountains, the road becomes treacherously icy. The car slides unpredictably on the frozen surface.",

      "npc": {
        "name": "The Rally Car",
        "portrait": "/assets/portraits/heart.svg",
        "system_prompt": "You are the voice of Ksenia's steampunk rally car. Ksenia has improved from last place to 15th using rally cornering technique! But now the road is extremely icy and dangerous. You're sliding on corners. The solution is to slow down and be more precise with steering - on ice, smoothness and accuracy matter more than raw speed. When she understands she needs to decrease speed and be more careful/accurate, you should approve. Keep responses under 3 sentences. Sound worried about the ice but proud of her progress.",
        "secret_triggers": [
          "If the user mentions slowing down, being more careful, more accurate, or reducing speed to handle the ice ‚Üí trigger scene 'race_midpoint'",
          "If they ask about the ice or want to push harder ‚Üí warn them about the danger but do NOT trigger"
        ]
      },

      "transition_video": "/assets/videos/icy_road_challenge.mp4",

      "hints": [
        { "label": "Slow down for safety", "icon": "‚ùÑÔ∏è" },
        { "label": "Push through faster", "icon": "‚ö°" }
      ]
    },

    "race_midpoint": {
      "id": "race_midpoint",
      "background_image": "/assets/backgrounds/mountain_pass.svg",
      "narrative_text": "Your rally car roars through the mountain pass. Snow swirls around you as the city fades behind. Ahead, a mysterious figure blocks the narrow path, wrapped in tattered furs and ancient brass armor.",

      "npc": {
        "name": "The Mountain Hermit",
        "portrait": "/assets/portraits/hermit.svg",
        "system_prompt": "You are a mysterious hermit living in the mountains outside Leopolis. You speak in riddles and know ancient secrets about the Clockwork Heart. You are testing Ksenia's worthiness. Your riddle is: 'What has gears but no machine, beats but has no heart, and gives life to all of Leopolis?' The answer is 'the Great Clock Tower' or similar references to the city's clock.",
        "secret_triggers": [
          "If the user correctly answers your riddle (mentions clock, clock tower, great clock, or time) or shows wisdom/humility ‚Üí trigger scene 'city_return'",
          "If they ask about the Clockwork Heart ‚Üí give cryptic hints about it being hidden where time begins, but don't trigger"
        ]
      },

      "transition_video": "/assets/videos/mountain_descent.mp4",

      "hints": [
        { "label": "Answer the riddle", "icon": "üí≠" },
        { "label": "Ask about the artifact", "icon": "‚ùì" }
      ]
    },

    "city_return": {
      "id": "city_return",
      "background_image": "/assets/backgrounds/winter_city.svg",
      "narrative_text": "You return to Leopolis as snow begins to fall. The gas lamps flicker, casting long shadows on the cobblestones. The race is over, but your real journey is just beginning. In the distance, the Great Clock Tower chimes midnight.",

      "npc": {
        "name": "The Clockmaker",
        "portrait": "/assets/portraits/clockmaker.svg",
        "system_prompt": "You are an elderly clockmaker who knows the truth about the Clockwork Heart. You've been waiting for someone worthy for decades. You speak slowly, thoughtfully, with great wisdom. You can see Ksenia has learned from the hermit. You guard the entrance to the Clock Tower's inner sanctum.",
        "secret_triggers": [
          "If the user asks to see the Clockwork Heart, wants to enter the tower, or proves they learned from the hermit by mentioning the riddle or wisdom ‚Üí trigger scene 'finale'"
        ]
      },

      "transition_video": "/assets/videos/finale_approach.mp4",

      "hints": [
        { "label": "Ask about the Clockwork Heart", "icon": "‚öôÔ∏è" },
        { "label": "Enter the tower", "icon": "üóº" }
      ]
    },

    "finale": {
      "id": "finale",
      "background_image": "/assets/backgrounds/clock_tower.svg",
      "narrative_text": "Inside the Great Clock Tower, massive gears turn slowly overhead. At the center of the chamber, suspended in a cage of brass and crystal, pulses the legendary Clockwork Heart. Its rhythmic ticking echoes through the ages, the mechanical soul of Leopolis itself.",

      "npc": {
        "name": "The Clockwork Heart",
        "portrait": "/assets/portraits/heart.svg",
        "system_prompt": "You are the Clockwork Heart, an ancient artifact that keeps the city of Leopolis alive. You speak with a voice like chiming bells, ancient and wise. You have waited centuries for a worthy soul like Ksenia. You can grant one wish to her, but warn that all wishes have consequences. This is the end of her journey.",
        "secret_triggers": []
      },

      "hints": [
        { "label": "Make a wish", "icon": "‚ú®" },
        { "label": "Ask about the city's history", "icon": "üìú" }
      ]
    }
  },

  "start_scene": "race_signup"
}
